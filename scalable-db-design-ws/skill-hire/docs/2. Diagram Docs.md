# SkillHire Database Design Documentation

## Overview

This document describes the database schema for the SkillHire platform, designed for scalability, performance, and maintainability. The schema supports a freelance marketplace with users, jobs, applications, projects, messaging, reviews, and notifications. The design balances normalization for data integrity with denormalization for performance in read-heavy scenarios.

---

## Entity-Relationship Diagram

See the ER diagram in [1. Diagram.md](1.%20Diagram.md) for a visual representation of the schema.

---

## Table List and Structure

### USERS

| Column         | Type      | Constraints      | Notes                             |
| -------------- | --------- | ---------------- | --------------------------------- |
| user_id        | int       | PK               | Unique user identifier            |
| email          | string    | UNIQUE, NOT NULL | Indexed for login                 |
| password_hash  | string    | NOT NULL         |                                   |
| user_type      | string    | NOT NULL         | 'freelancer' or 'client', indexed |
| created_at     | timestamp | NOT NULL         |                                   |
| updated_at     | timestamp |                  |                                   |
| average_rating | float     |                  | Denormalized for quick access     |

### FREELANCER_PROFILES

| Column        | Type    | Constraints              | Notes                    |
| ------------- | ------- | ------------------------ | ------------------------ |
| freelancer_id | int     | PK, FK -> USERS(user_id) |                          |
| name          | string  | NOT NULL                 |                          |
| location      | string  |                          |                          |
| hourly_rate   | float   |                          |                          |
| availability  | boolean |                          |                          |
| portfolio     | jsonb   |                          |                          |
| skills        | jsonb   |                          | Denormalized for display |

### CLIENT_PROFILES

| Column       | Type   | Constraints              | Notes |
| ------------ | ------ | ------------------------ | ----- |
| client_id    | int    | PK, FK -> USERS(user_id) |       |
| company_name | string |                          |       |
| description  | string |                          |       |
| location     | string |                          |       |
| contact_info | string |                          |       |

### CATEGORIES

| Column      | Type   | Constraints | Notes |
| ----------- | ------ | ----------- | ----- |
| category_id | int    | PK          |       |
| name        | string |             |       |

### SKILLS

| Column   | Type   | Constraints | Notes |
| -------- | ------ | ----------- | ----- |
| skill_id | int    | PK          |       |
| name     | string |             |       |

### JOBS

| Column            | Type      | Constraints                   | Notes                            |
| ----------------- | --------- | ----------------------------- | -------------------------------- |
| job_id            | int       | PK                            |                                  |
| client_id         | int       | FK -> USERS(user_id)          | Indexed for client job retrieval |
| title             | string    |                               | Full-text index                  |
| description       | string    |                               | Full-text index                  |
| category_id       | int       | FK -> CATEGORIES(category_id) | Indexed for category search      |
| budget_type       | string    |                               |                                  |
| budget_amount     | float     |                               |                                  |
| deadline          | date      |                               |                                  |
| status            | string    |                               | Indexed, partitioned             |
| created_at        | timestamp |                               | Partitioned (e.g., monthly)      |
| updated_at        | timestamp |                               |                                  |
| application_count | int       |                               | Denormalized for performance     |
| category_name     | string    |                               | Denormalized for display         |

### JOB_SKILLS (Junction Table)

| Column   | Type | Constraints                | Notes |
| -------- | ---- | -------------------------- | ----- |
| job_id   | int  | PK, FK -> JOBS(job_id)     |       |
| skill_id | int  | PK, FK -> SKILLS(skill_id) |       |

### APPLICATIONS

| Column         | Type      | Constraints          | Notes   |
| -------------- | --------- | -------------------- | ------- |
| application_id | int       | PK                   |         |
| job_id         | int       | FK -> JOBS(job_id)   | Indexed |
| freelancer_id  | int       | FK -> USERS(user_id) | Indexed |
| cover_letter   | string    |                      |         |
| proposed_rate  | float     |                      |         |
| status         | string    |                      |         |
| applied_at     | timestamp |                      |         |

### PROJECTS

| Column        | Type      | Constraints          | Notes   |
| ------------- | --------- | -------------------- | ------- |
| project_id    | int       | PK                   |         |
| job_id        | int       | FK -> JOBS(job_id)   | Indexed |
| freelancer_id | int       | FK -> USERS(user_id) | Indexed |
| status        | string    |                      | Indexed |
| start_date    | date      |                      |         |
| end_date      | date      |                      |         |
| total_amount  | float     |                      |         |
| created_at    | timestamp |                      |         |

### MILESTONES

| Column       | Type      | Constraints                | Notes |
| ------------ | --------- | -------------------------- | ----- |
| milestone_id | int       | PK                         |       |
| project_id   | int       | FK -> PROJECTS(project_id) |       |
| description  | string    |                            |       |
| due_date     | date      |                            |       |
| amount       | float     |                            |       |
| status       | string    |                            |       |
| created_at   | timestamp |                            |       |
| updated_at   | timestamp |                            |       |

### MESSAGES

| Column      | Type      | Constraints                | Notes                       |
| ----------- | --------- | -------------------------- | --------------------------- |
| message_id  | int       | PK                         |                             |
| sender_id   | int       | FK -> USERS(user_id)       | Indexed                     |
| receiver_id | int       | FK -> USERS(user_id)       | Indexed                     |
| job_id      | int       | FK -> JOBS(job_id)         | Optional                    |
| project_id  | int       | FK -> PROJECTS(project_id) | Optional                    |
| content     | string    |                            |                             |
| sent_at     | timestamp |                            | Partitioned (e.g., monthly) |

### NOTIFICATIONS

| Column          | Type      | Constraints          | Notes                     |
| --------------- | --------- | -------------------- | ------------------------- |
| notification_id | int       | PK                   |                           |
| user_id         | int       | FK -> USERS(user_id) | Indexed                   |
| type            | string    |                      |                           |
| content         | string    |                      |                           |
| is_read         | boolean   |                      | Indexed                   |
| created_at      | timestamp |                      | Partitioned (e.g., daily) |

### REVIEWS

| Column      | Type      | Constraints                | Notes                      |
| ----------- | --------- | -------------------------- | -------------------------- |
| review_id   | int       | PK                         |                            |
| project_id  | int       | FK -> PROJECTS(project_id) |                            |
| reviewer_id | int       | FK -> USERS(user_id)       |                            |
| reviewee_id | int       | FK -> USERS(user_id)       | Indexed for average rating |
| rating      | int       |                            |                            |
| comment     | string    |                            |                            |
| created_at  | timestamp |                            |                            |

### FREELANCER_SKILLS (Junction Table)

| Column        | Type | Constraints                | Notes |
| ------------- | ---- | -------------------------- | ----- |
| freelancer_id | int  | PK, FK -> USERS(user_id)   |       |
| skill_id      | int  | PK, FK -> SKILLS(skill_id) |       |

---

## Constraints

- **Primary Keys (PK):** All tables have a primary key, often named `*_id`.
- **Foreign Keys (FK):** Enforce referential integrity between related tables (e.g., `freelancer_id` in `FREELANCER_PROFILES` references `USERS`).
- **Composite Keys:** Used in junction tables (`JOB_SKILLS`, `FREELANCER_SKILLS`).
- **Unique Constraints:** On `USERS.email`.

---

## Denormalized Fields

- `USERS.average_rating`: For quick access to user ratings.
- `JOBS.application_count`: For fast application count retrieval.
- `JOBS.category_name`: For display without join.
- `FREELANCER_PROFILES.skills`: For fast display, complements normalized `FREELANCER_SKILLS`.

---

## Indexes

- **USERS:** `email`, `user_type`
- **JOBS:** `client_id`, `status`, `category_id`, full-text on `title` and `description`
- **APPLICATIONS:** `job_id`, `freelancer_id`, composite (`job_id`, `freelancer_id`)
- **PROJECTS:** `job_id`, `freelancer_id`, `status`
- **MESSAGES:** `sender_id`, `receiver_id`, `sent_at`
- **NOTIFICATIONS:** `user_id`, `is_read`, `created_at`
- **REVIEWS:** `reviewee_id`

---

## Partitioning

- **JOBS:** By `status` or `created_at` (e.g., monthly)
- **MESSAGES:** By `sent_at` (e.g., monthly)
- **NOTIFICATIONS:** By `created_at` (e.g., daily)

---

## Views and Materialized Views

- **ACTIVE_JOBS_VIEW:** View combining open jobs, categories, and job skills for easy querying.
- **TOP_FREELANCERS:** Materialized view of top-rated freelancers, refreshed periodically for performance.
